external procedure ExtractObj(string,var Integer,var string);global //Edit***************************Sasha2,11:22 22.09.2016 {updating procedure CustomRegisterRemoveMn(record RcVc RepSpec)begin  record IVCashVc IVCashr;      if (RepSpec.flags[0]==1) then begin      IVCashr.SerNr = -1;      while (LoopMain(IVCashr,1,true)) begin        recorddelete(IVCashr);        StepBack(IVCashr);      end;    end;	  return;end; //Edit***************************Sasha2,11:22 22.09.2016 }globalfunction string 255 RetrieveStoreObject(var record ARVc APr) //for APSClass CalculatedColumn. APSClass uses APVc, but this function works with ARVc!begin  record VIVc VIr;  record ObjVc Objr;  string 20 storeObj,curObj;  Integer pos;      VIr.SerNr = APr.InvoiceNr;    if (ReadFirstMain(VIr,1,true)) then begin      pos = 0;      ExtractObj(VIr.Objects,pos,curObj);      while (nonblank(curObj)) begin        Objr.Code = curObj;        if (ReadFirstMain(Objr,1,true) and Objr.OTCode=="STORE") then begin          storeObj = Objr.Code;          pos = len(VIr.Objects);        end;        ExtractObj(VIr.Objects,pos,curObj);      end;    end;    RetrieveStoreObject = storeObj;  return;end;